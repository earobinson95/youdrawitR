<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="youdrawitR">
<title>drawr-example â€¢ youdrawitR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="drawr-example">
<meta property="og:description" content="youdrawitR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">youdrawitR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/drawr-example.html">drawr-example</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="drawr-example_files/htmlwidgets-1.6.2/htmlwidgets.js"></script><script src="drawr-example_files/r2d3-render-0.1.0/r2d3-render.js"></script><script src="drawr-example_files/webcomponents-2.0.0/webcomponents.js"></script><script src="drawr-example_files/r2d3-binding-0.2.6/r2d3.js"></script><script src="drawr-example_files/d3v5-5.9.2/d3.min.js"></script><script src="drawr-example_files/d3-jetpack-2.0.9/d3-jetpack.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>drawr-example</h1>
            
      
      
      <div class="d-none name"><code>drawr-example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://earobinson95.github.io/youdrawitR/">youdrawitR</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="drawr-output">Drawr Output<a class="anchor" aria-label="anchor" href="#drawr-output"></a>
</h2>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/linearDataGen.html">linearDataGen</a></span><span class="op">(</span>y_xbar <span class="op">=</span> <span class="fl">3.9</span>,</span>
<span>                      slope  <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                      sigma  <span class="op">=</span> <span class="fl">2.8</span>,</span>
<span>                      x_min   <span class="op">=</span> <span class="fl">0</span>,</span>
<span>                      x_max   <span class="op">=</span> <span class="fl">20</span>,</span>
<span>                      N       <span class="op">=</span> <span class="fl">40</span>,</span>
<span>                      x_by    <span class="op">=</span> <span class="fl">0.25</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/drawr.html">drawr</a></span><span class="op">(</span><span class="va">data</span>, show_tooltip <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<div class="r2d3 html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6c13805bd200c1ea90d4" style="width:700px;height:432.632880098888px;"></div>
<script type="application/json" data-for="htmlwidget-6c13805bd200c1ea90d4">{"x":{"data":{"point_data":[{"data":"point_data","x":0,"y":-1.7878,"_row":1},{"data":"point_data","x":0.5128,"y":-0.3663,"_row":2},{"data":"point_data","x":1.0256,"y":-2.8133,"_row":3},{"data":"point_data","x":1.5385,"y":3.2335,"_row":4},{"data":"point_data","x":2.0513,"y":-0.4536,"_row":5},{"data":"point_data","x":2.5641,"y":-3.7228,"_row":6},{"data":"point_data","x":3.0769,"y":-4.173,"_row":7},{"data":"point_data","x":3.5897,"y":-0.1052,"_row":8},{"data":"point_data","x":4.1026,"y":-2.1758,"_row":9},{"data":"point_data","x":4.6154,"y":-3.9582,"_row":10},{"data":"point_data","x":5.1282,"y":1.9555,"_row":11},{"data":"point_data","x":5.641,"y":-1.1279,"_row":12},{"data":"point_data","x":6.1538,"y":-2.9978,"_row":13},{"data":"point_data","x":6.6667,"y":-7.1065,"_row":14},{"data":"point_data","x":7.1795,"y":-0.2842,"_row":15},{"data":"point_data","x":7.6923,"y":0.7713,"_row":16},{"data":"point_data","x":8.2051,"y":2.2805,"_row":17},{"data":"point_data","x":8.7179,"y":2.5476,"_row":18},{"data":"point_data","x":9.2308,"y":3.0872,"_row":19},{"data":"point_data","x":9.7436,"y":6.9591,"_row":20},{"data":"point_data","x":10.2564,"y":3.718,"_row":21},{"data":"point_data","x":10.7692,"y":6.0179,"_row":22},{"data":"point_data","x":11.2821,"y":6.0346,"_row":23},{"data":"point_data","x":11.7949,"y":5.7628,"_row":24},{"data":"point_data","x":12.3077,"y":5.2603,"_row":25},{"data":"point_data","x":12.8205,"y":4.8915,"_row":26},{"data":"point_data","x":13.3333,"y":4.7067,"_row":27},{"data":"point_data","x":13.8462,"y":2.7689,"_row":28},{"data":"point_data","x":14.359,"y":8.1638,"_row":29},{"data":"point_data","x":14.8718,"y":9.075,"_row":30},{"data":"point_data","x":15.3846,"y":8.6015,"_row":31},{"data":"point_data","x":15.8974,"y":7.777,"_row":32},{"data":"point_data","x":16.4103,"y":5.4285,"_row":33},{"data":"point_data","x":16.9231,"y":5.7307,"_row":34},{"data":"point_data","x":17.4359,"y":10.9656,"_row":35},{"data":"point_data","x":17.9487,"y":9.5764,"_row":36},{"data":"point_data","x":18.4615,"y":9.9708,"_row":37},{"data":"point_data","x":18.9744,"y":7.9401,"_row":38},{"data":"point_data","x":19.4872,"y":15.5495,"_row":39},{"data":"point_data","x":20,"y":8.7782,"_row":40}],"line_data":[{"data":"line_data","x":0,"y":-3.7458,"coef":0.7158,"int":-3.7458,"_row":1},{"data":"line_data","x":0.25,"y":-3.5669,"coef":0.7158,"int":-3.7458,"_row":2},{"data":"line_data","x":0.5,"y":-3.388,"coef":0.7158,"int":-3.7458,"_row":3},{"data":"line_data","x":0.75,"y":-3.209,"coef":0.7158,"int":-3.7458,"_row":4},{"data":"line_data","x":1,"y":-3.0301,"coef":0.7158,"int":-3.7458,"_row":5},{"data":"line_data","x":1.25,"y":-2.8511,"coef":0.7158,"int":-3.7458,"_row":6},{"data":"line_data","x":1.5,"y":-2.6722,"coef":0.7158,"int":-3.7458,"_row":7},{"data":"line_data","x":1.75,"y":-2.4932,"coef":0.7158,"int":-3.7458,"_row":8},{"data":"line_data","x":2,"y":-2.3143,"coef":0.7158,"int":-3.7458,"_row":9},{"data":"line_data","x":2.25,"y":-2.1353,"coef":0.7158,"int":-3.7458,"_row":10},{"data":"line_data","x":2.5,"y":-1.9564,"coef":0.7158,"int":-3.7458,"_row":11},{"data":"line_data","x":2.75,"y":-1.7774,"coef":0.7158,"int":-3.7458,"_row":12},{"data":"line_data","x":3,"y":-1.5985,"coef":0.7158,"int":-3.7458,"_row":13},{"data":"line_data","x":3.25,"y":-1.4195,"coef":0.7158,"int":-3.7458,"_row":14},{"data":"line_data","x":3.5,"y":-1.2406,"coef":0.7158,"int":-3.7458,"_row":15},{"data":"line_data","x":3.75,"y":-1.0617,"coef":0.7158,"int":-3.7458,"_row":16},{"data":"line_data","x":4,"y":-0.8827,"coef":0.7158,"int":-3.7458,"_row":17},{"data":"line_data","x":4.25,"y":-0.7038,"coef":0.7158,"int":-3.7458,"_row":18},{"data":"line_data","x":4.5,"y":-0.5248,"coef":0.7158,"int":-3.7458,"_row":19},{"data":"line_data","x":4.75,"y":-0.3459,"coef":0.7158,"int":-3.7458,"_row":20},{"data":"line_data","x":5,"y":-0.1669,"coef":0.7158,"int":-3.7458,"_row":21},{"data":"line_data","x":5.25,"y":0.012,"coef":0.7158,"int":-3.7458,"_row":22},{"data":"line_data","x":5.5,"y":0.191,"coef":0.7158,"int":-3.7458,"_row":23},{"data":"line_data","x":5.75,"y":0.3699,"coef":0.7158,"int":-3.7458,"_row":24},{"data":"line_data","x":6,"y":0.5489,"coef":0.7158,"int":-3.7458,"_row":25},{"data":"line_data","x":6.25,"y":0.7278,"coef":0.7158,"int":-3.7458,"_row":26},{"data":"line_data","x":6.5,"y":0.9068,"coef":0.7158,"int":-3.7458,"_row":27},{"data":"line_data","x":6.75,"y":1.0857,"coef":0.7158,"int":-3.7458,"_row":28},{"data":"line_data","x":7,"y":1.2646,"coef":0.7158,"int":-3.7458,"_row":29},{"data":"line_data","x":7.25,"y":1.4436,"coef":0.7158,"int":-3.7458,"_row":30},{"data":"line_data","x":7.5,"y":1.6225,"coef":0.7158,"int":-3.7458,"_row":31},{"data":"line_data","x":7.75,"y":1.8015,"coef":0.7158,"int":-3.7458,"_row":32},{"data":"line_data","x":8,"y":1.9804,"coef":0.7158,"int":-3.7458,"_row":33},{"data":"line_data","x":8.25,"y":2.1594,"coef":0.7158,"int":-3.7458,"_row":34},{"data":"line_data","x":8.5,"y":2.3383,"coef":0.7158,"int":-3.7458,"_row":35},{"data":"line_data","x":8.75,"y":2.5173,"coef":0.7158,"int":-3.7458,"_row":36},{"data":"line_data","x":9,"y":2.6962,"coef":0.7158,"int":-3.7458,"_row":37},{"data":"line_data","x":9.25,"y":2.8752,"coef":0.7158,"int":-3.7458,"_row":38},{"data":"line_data","x":9.5,"y":3.0541,"coef":0.7158,"int":-3.7458,"_row":39},{"data":"line_data","x":9.75,"y":3.2331,"coef":0.7158,"int":-3.7458,"_row":40},{"data":"line_data","x":10,"y":3.412,"coef":0.7158,"int":-3.7458,"_row":41},{"data":"line_data","x":10.25,"y":3.591,"coef":0.7158,"int":-3.7458,"_row":42},{"data":"line_data","x":10.5,"y":3.7699,"coef":0.7158,"int":-3.7458,"_row":43},{"data":"line_data","x":10.75,"y":3.9488,"coef":0.7158,"int":-3.7458,"_row":44},{"data":"line_data","x":11,"y":4.1278,"coef":0.7158,"int":-3.7458,"_row":45},{"data":"line_data","x":11.25,"y":4.3067,"coef":0.7158,"int":-3.7458,"_row":46},{"data":"line_data","x":11.5,"y":4.4857,"coef":0.7158,"int":-3.7458,"_row":47},{"data":"line_data","x":11.75,"y":4.6646,"coef":0.7158,"int":-3.7458,"_row":48},{"data":"line_data","x":12,"y":4.8436,"coef":0.7158,"int":-3.7458,"_row":49},{"data":"line_data","x":12.25,"y":5.0225,"coef":0.7158,"int":-3.7458,"_row":50},{"data":"line_data","x":12.5,"y":5.2015,"coef":0.7158,"int":-3.7458,"_row":51},{"data":"line_data","x":12.75,"y":5.3804,"coef":0.7158,"int":-3.7458,"_row":52},{"data":"line_data","x":13,"y":5.5594,"coef":0.7158,"int":-3.7458,"_row":53},{"data":"line_data","x":13.25,"y":5.7383,"coef":0.7158,"int":-3.7458,"_row":54},{"data":"line_data","x":13.5,"y":5.9173,"coef":0.7158,"int":-3.7458,"_row":55},{"data":"line_data","x":13.75,"y":6.0962,"coef":0.7158,"int":-3.7458,"_row":56},{"data":"line_data","x":14,"y":6.2751,"coef":0.7158,"int":-3.7458,"_row":57},{"data":"line_data","x":14.25,"y":6.4541,"coef":0.7158,"int":-3.7458,"_row":58},{"data":"line_data","x":14.5,"y":6.633,"coef":0.7158,"int":-3.7458,"_row":59},{"data":"line_data","x":14.75,"y":6.812,"coef":0.7158,"int":-3.7458,"_row":60},{"data":"line_data","x":15,"y":6.9909,"coef":0.7158,"int":-3.7458,"_row":61},{"data":"line_data","x":15.25,"y":7.1699,"coef":0.7158,"int":-3.7458,"_row":62},{"data":"line_data","x":15.5,"y":7.3488,"coef":0.7158,"int":-3.7458,"_row":63},{"data":"line_data","x":15.75,"y":7.5278,"coef":0.7158,"int":-3.7458,"_row":64},{"data":"line_data","x":16,"y":7.7067,"coef":0.7158,"int":-3.7458,"_row":65},{"data":"line_data","x":16.25,"y":7.8857,"coef":0.7158,"int":-3.7458,"_row":66},{"data":"line_data","x":16.5,"y":8.0646,"coef":0.7158,"int":-3.7458,"_row":67},{"data":"line_data","x":16.75,"y":8.2436,"coef":0.7158,"int":-3.7458,"_row":68},{"data":"line_data","x":17,"y":8.4225,"coef":0.7158,"int":-3.7458,"_row":69},{"data":"line_data","x":17.25,"y":8.6014,"coef":0.7158,"int":-3.7458,"_row":70},{"data":"line_data","x":17.5,"y":8.7804,"coef":0.7158,"int":-3.7458,"_row":71},{"data":"line_data","x":17.75,"y":8.9593,"coef":0.7158,"int":-3.7458,"_row":72},{"data":"line_data","x":18,"y":9.1383,"coef":0.7158,"int":-3.7458,"_row":73},{"data":"line_data","x":18.25,"y":9.3172,"coef":0.7158,"int":-3.7458,"_row":74},{"data":"line_data","x":18.5,"y":9.4962,"coef":0.7158,"int":-3.7458,"_row":75},{"data":"line_data","x":18.75,"y":9.6751,"coef":0.7158,"int":-3.7458,"_row":76},{"data":"line_data","x":19,"y":9.8541,"coef":0.7158,"int":-3.7458,"_row":77},{"data":"line_data","x":19.25,"y":10.033,"coef":0.7158,"int":-3.7458,"_row":78},{"data":"line_data","x":19.5,"y":10.212,"coef":0.7158,"int":-3.7458,"_row":79},{"data":"line_data","x":19.75,"y":10.3909,"coef":0.7158,"int":-3.7458,"_row":80},{"data":"line_data","x":20,"y":10.5699,"coef":0.7158,"int":-3.7458,"_row":81}]},"type":"json","container":"svg","options":{"draw_start":2.225073858507201e-308,"run_app":false,"points_end":null,"linear":"true","log_base":null,"free_draw":true,"points":"full","aspect_ratio":1,"pin_start":true,"x_range":[0,20],"x_by":0,"x_lab":"","y_range":[-8.239287718721839,16.68228125327374],"y_lab":"","subtitle":"","line_style":null,"drawn_line_color":"steelblue","show_finished":true,"show_tooltip":true,"title":"","conf_int":false},"script":"var d3Script = function(d3, r2d3, data, svg, width, height, options, theme, console) {\nthis.d3 = d3;\n\nsvg = d3.select(svg.node());\n/* R2D3 Source File:  /home/runner/.cache/R/renv/library/youdrawitR-b8afb6e4/R-4.3/x86_64-pc-linux-gnu/youdrawitR/www/you-draw-it.js */\n// !preview r2d3 data = data, options = options, dependencies = c('d3-jetpack'), d3_version = \"5\", viewer = \"browser\"\n\n// Make sure R has the following loaded\n// library(tibble)\n// data_to_json <- function(data) {jsonlite::toJSON(data, dataframe = \"rows\", auto_unbox = FALSE, rownames = TRUE)} \n\n\n// define variable system_font\n const system_font = `-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, Helvetica, Arial, sans-serif, \"Apple Color // // Emoji\", \"Segoe UI Emoji\", \"Segoe UI Symbol\"`;\n\n\n// ---------------------------------------------------------------------------------------------\n\n\n// define variable margins\n// if x_lab and title true top = 30, if only title, top = 40, if only x top = 15, if neither top = 10.\nconst margin = {left: 55, \n                right: 10, \n               // top: options.title ? 40: 10, \n              //  bottom: options.title? 25: 55};\n                top: (options.subtitle) ? 40 : (options.title && options.x_lab) ? 30 : (options.title ? 40 : (options.x_lab ? 15 : 10)),\n                bottom: (options.subtitle) ? 30 : (options.title && options.x_lab) ? 35 : (options.title ? 25 : (options.x_lab ? 35 : 55))};\n\n// define variable default line attributes\n// do not fill the line in (default is filled in black beneath the line)\n// stroke provides the color of the line stroke. This is either options.data_line_color (not yet defined) or steelblue\n// sets the the stroke width (how thick)\n// sets how tojoin the lines? and end the lines? rounded.\n// Since we are using Object.assign, we are passing the source options.line_style into the vector of information defined. See top for options list.\nconst default_line_attrs = Object.assign({\n  fill: \"none\",\n  stroke: options.data_line_color || 'steelblue',\n  strokeWidth: 4,\n  strokeLinejoin: \"round\",\n  strokeLinecap: \"round\",\n}, options.line_style);\n\nconst conf_int_line_attrs = Object.assign({\n  fill: \"none\",\n  stroke: options.data_line_color || 'steelblue',\n  strokeWidth: 2,\n  strokeLinejoin: \"round\",\n  strokeLinecap: \"round\",\n  strokeDasharray: \"10, 20\"\n}, options.line_style);\n\n// defines a changing variable called state??\n// provides the data from top\n// appends the svg group and moves it to the correct location...\n// sets the width and height of the plot\n// Since we are using object.assign, the options are passed in as the source, this will \"overwrite\" any information provided in the options???\n// Is state like our wrapper?\n\nlet state = Object.assign({\n  line_data: data.line_data,\n  point_data: data.point_data,\n  lower_bound: data.lower_bound,\n  upper_bound: data.upper_bound,\n  svg: svg.append('g').translate([margin.left, margin.top]).attr(\"class\", \"wrapper\"),\n  w: height*options.aspect_ratio - margin.left - margin.right,\n  h: height - margin.top - margin.bottom,\n}, options);\n\n// option variables are passed into state\n// console.log(state.y_range)\n\n// To distinguish between code that runs at initialization-time only and\n// code that runs when data changes, organize your code so that the code\n// which responds to data changes is contained within the r2d3.onRender()\n// https://rstudio.github.io/r2d3/articles/advanced_rendering.html\nr2d3.onRender(function(data, svg, width, height, options) {\n  \n  state.line_data = data.line_data;\n  state.point_data = data.point_data;\n  state = Object.assign(state, options);\n  if (state.conf_int) {\n    state.lower_bound = data.lower_bound;\n    state.upper_bound = data.upper_bound;\n  }\n  state.options = options;\n  state.w = height*options.aspect_ratio;\n\n  start_drawer(state);\n  \n  if (!state.run_app) {\n    // add download data buttons\n  const downloadButton = svg.append(\"g\")\n    .attr(\"class\", \"button\")\n    .style(\"cursor\", \"pointer\")\n    .attr(\"transform\", \n      `translate(${state.w + margin.right + margin.left}, ${margin.top})`)\n    .on(\"click\", handleDownloadClick);\n\n  downloadButton.append(\"rect\")\n    .attr(\"x\", 0)\n    .attr(\"y\", 0)\n    .attr(\"width\", 110)\n    .attr(\"height\", 25)\n    .attr(\"rx\", 5)\n    .attr(\"ry\", 5)\n    .style(\"fill\", \"#ECECEC\")\n    .style(\"stroke\", \"black\")\n    .style(\"stroke-width\", 2)\n    \n  downloadButton.on(\"mouseover\", function() {\n    d3.select(this).select(\"rect\")\n      .style(\"fill\", \"darkgray\");\n  })\n  .on(\"mouseout\", function() {\n    d3.select(this).select(\"rect\")\n      .style(\"fill\", \"#ECECEC\");\n  });\n  \n  downloadButton.append(\"text\")\n    .attr(\"x\", 55)\n    .attr(\"y\", 12.5)\n    .attr(\"text-anchor\", \"middle\")\n    .attr(\"alignment-baseline\", \"middle\")\n    .attr(\"fill\", \"black\")\n    .attr(\"font-size\", 14)\n    .text(\"Download Data\");\n  \n  function handleDownloadClick() {\n    var drawn_line = svg.select(\"path.user_line\").datum();\n    var jsonData = JSON.stringify(drawn_line);\n    var bb = new Blob([jsonData], { type: 'text/plain' });\n    var a = document.createElement('a');\n    a.download = 'draw_line_data.txt';\n    a.href = window.URL.createObjectURL(bb);\n    a.click();\n  }\n  }\n});\n\n// An explicit resize handler\n// is this like our bounds??? or does this have to do with scales?\n// https://rstudio.github.io/r2d3/articles/advanced_rendering.html\n// redraws plot as you resize your browser window \n// (box has changed size that we did not do on code end)\nr2d3.onResize(function(width, height, options) {\n  state.w = height*state.options.aspect_ratio;\n  state.h = height - margin.top - margin.bottom;\n\n//  start_drawer(state, reset = false);\n\n});\n\n//function calculateDistance(user_line, line_data) {\n//  let totalDistance = 0;\n//  let pt_count = 0;\n//\n//  // Iterate over the points of user_line\n//  for (let i = 0; i < user_line.length; i++) {\n//    const point1 = user_line[i];\n//    const correspondingPoint = line_data.find(point => point.x === point1.x);\n//\n//    if (correspondingPoint && correspondingPoint.y !== null) {\n//      pt_count += 1\n//      // Calculate the distance between the y-values of the two points\n//      const distance = Math.abs(point1.y - correspondingPoint.y);\n//      totalDistance += distance;\n//    }\n//  }\n//  const averageDistance = totalDistance / pt_count;\n//\n//  return averageDistance;\n//}\n\n// JSON.stringify()\n// Main function that draws current state of viz\n// set up scales & draw true line if we decide to do that.\nfunction start_drawer(state, reset = true){\n  const scales = setup_scales(state);\n  \n  if(!state.free_draw){\n    draw_true_line(state, scales, state.draw_start);\n  }\n  \n  // Cover hidden portion with a rectangle\n  // const line_hider = setup_line_hider(state.svg, state.draw_start, scales);\n  \n  // if we reset (these are points that can be drawn) remove what user has drawn.\n  if(reset){\n    // start with the svg object provided by r2d3\n    // multiassign where setup_drawable_points is grabbing the parameters it needs from state: data, freedraw and draw_start\n    state.drawable_points = setup_drawable_points(state);\n  }\n  \n  // if we have points, we draw user's line.\n  draw_user_line(state, scales);\n  draw_rectangle(state, scales);\n  draw_finished_line(state, scales, state.draw_start);\n  \n    // draw points for initial portion\n  if(state.points != \"none\"){\n    draw_points(state, scales);\n  }\n  \n  // invert from pixle to data scale when they draw their points\n  // THIS IS WHERE WE SET A SPECIFIC NUMBER OF POINTS THAT CAN BE DRAWN CORRESPONDING TO 1/2 UNITS ON DATA SCALE...MAKES IT CLUNKY: CONTROLED BY TIBBLE\n  // ISSUES HERE!!!\n  const on_drag = function(){\n    const drag_x = scales.x.invert(d3.event.x);\n    const drag_y = scales.y.invert(d3.event.y);\n    fill_in_closest_point(state, drag_x, drag_y);\n    draw_user_line(state, scales);\n    draw_rectangle(state, scales);\n  };\n  \n  // line_status is set by draw watcher - get user status line\n  // if some points missing - in progress\n  // complete line - done\n  // passes drawn points to shiny when click done\n  // as long as there are dots (missing spaces) it isn't going to pass data back.\n  const on_end = function(){\n    // Check if all points are drawn so we can reveal line\n    const line_status = get_user_line_status(state);\n    \n    if(line_status === 'done'){\n      // User has completed line drawing\n      //if(state.show_finished) line_hider.reveal();\n      //if(!state.free_draw)  line_hider.reveal();\n      if(state.show_finished){\n        draw_finished_line(state, scales, state.draw_start);\n      }\n//      const distance = calculateDistance(svg.select(\"path.user_line\").datum(), state.line_data).toFixed(4);\n//      console.log('Average distance between the drawn line and actual line: '+ distance);\n      \n      \n      // Convert the completedLine to JSON\n      if(typeof Shiny !== 'undefined') {\n        var jsonData = JSON.stringify(svg.select(\"path.user_line\").datum());\n      \n        // Send the data to the Shiny server\n        Shiny.setInputValue(\"completedLineData\", jsonData);\n      }\n      \n      // Send the JSON data to R using an HTTP request\n      // var request = new XMLHttpRequest();\n    //  request.open(\"POST\", \"http://localhost:8000\", true);\n  //    request.setRequestHeader(\"Content-Type\", \"application/json\");\n//      request.send(jsonData);\n      \n    }\n  };\n  \n    if(typeof Shiny !== 'undefined') {\n    Shiny.addCustomMessageHandler('resetAction', function(reset) {\n      paths.forEach(function(path) {\n        path.remove();\n      });\n    \n      // Reset paths and lineGens arrays\n      paths = [];\n      lineGens = [];\n      \n      if (isDrawing) {\n        newLine();\n      }\n      start_drawer(state, reset);\n    });\n    \n    Shiny.addCustomMessageHandler('newLine', function(drawing){\n      newLine()\n    });\n  }\n\n  // Press button to be able to draw more lines\n  var lineGen, path, data = [];\n  var mousedown = false;\n  var isDrawing = false;\n  var draw_watcher = null;\n  var paths = [];\n  var lineGens = [];\n  \n  function newLine() {\n    if (isDrawing) {\n      // Stop drawing and remove new draw watcher\n      isDrawing = false;\n      if (!state.run_app) {\n      buttonText.text(\"New Line\");\n        buttonRect.transition().duration(200).style(\"fill\", \"#ECECEC\");\n      }\n      draw_watcher.remove();\n  \n      // Reattach the original event handlers\n      svg.select('rect.drag_watcher').call(\n        d3.drag()\n        .on(\"drag\", on_drag)\n        .on(\"end\", on_end)\n      );\n  \n      return;\n    }\n  \n    // Start drawing and create new draw watcher\n    isDrawing = true;\n    if (!state.run_app) {\n      buttonText.text(\"Stop Drawing\");\n      buttonRect.transition().duration(200).style(\"fill\", \"red\");\n    }\n    \n    // Detach the original event handlers\n    svg.select('rect.drag_watcher').on(\".drag\", null);\n  \n    lineGen = d3.line()\n      .x(function (d) { return d.x; })\n      .y(function (d) { return d.y; });\n    \n    // Store the line generator\n    lineGens.push(lineGen);\n  \n    path = state.svg.append('path')\n      .at(conf_int_line_attrs)\n      .attr(\"opacity\", 0.75);\n      \n    // Store the path\n    paths.push(path);\n  \n    data = [];  // clear data for new line\n  \n  draw_watcher = state.svg.append('rect')\n    .attr('class', 'draw_watcher')\n    .attr('height', scales.y.range()[0])\n    .attr('width', scales.x.range()[1])\n    .attr('fill', 'grey')\n    .attr('fill-opacity', 0)\n    .call(\n      d3.drag()\n      .on(\"start\", function() {\n        mousedown = true;\n        var coords = d3.mouse(this);\n        if (!coordsInWatcher(coords)) return;\n        data.push({ x: coords[0], y: coords[1] });\n        path.attr('d', lineGen(data));\n      })\n      .on(\"drag\", function() {\n        if (!mousedown) return;\n        var coords = d3.mouse(this);\n        if (!coordsInWatcher(coords)) return;\n        data.push({ x: coords[0], y: coords[1] });\n        path.attr('d', lineGen(data));\n      })\n      .on(\"end\", function() {\n        mousedown = false;\n      })\n    )\n    .on('mouseout', function() {\n      mousedown = false;\n    });\n\n  // Check if mouse is within draw_watcher\n  function coordsInWatcher(coords) {\n    var bounds = draw_watcher.node().getBBox();\n    return coords[0] >= bounds.x && coords[0] <= bounds.x + bounds.width\n      && coords[1] >= bounds.y && coords[1] <= bounds.y + bounds.height;\n  }\n  }\n  \n  if (!state.run_app) {\n    const button = svg.append(\"g\")\n      .attr(\"class\", \"button\")\n      .style(\"cursor\", \"pointer\")\n      .attr(\"transform\", `translate(${state.w + margin.right + margin.left}, ${margin.top + 75})`)\n      .on(\"click\", newLine);\n    \n    var buttonRect = button.append(\"rect\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"width\", 80)\n      .attr(\"height\", 25)\n      .attr(\"rx\", 5)\n      .attr(\"ry\", 5)\n      .style(\"fill\", \"#ECECEC\")\n      .style(\"stroke\", \"black\")\n      .style(\"stroke-width\", 2);\n    \n    button.on(\"mouseover\", function() {\n      if (!isDrawing) {\n        d3.select(this).select(\"rect\")\n          .style(\"fill\", \"darkgray\");\n      }\n      else {\n        d3.select(this).select(\"rect\")\n          .style(\"fill\", \"darkred\");\n      }\n    })\n    .on(\"mouseout\", function() {\n      if (!isDrawing) {\n        d3.select(this).select(\"rect\")\n          .style(\"fill\", \"#ECECEC\");\n      }\n            else {\n        d3.select(this).select(\"rect\")\n          .style(\"fill\", \"red\");\n      }\n    });\n    \n    var buttonText = button.append(\"text\")\n      .attr(\"x\", 40)\n      .attr(\"y\", 15)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"alignment-baseline\", \"middle\")\n      .attr(\"fill\", \"black\")\n      .attr(\"font-size\", 14)\n      .text(\"New Line\");\n\n    // add draw line and reset buttons\n        const resetButton = svg.append(\"g\")\n      .attr(\"class\", \"button\")\n      .style(\"cursor\", \"pointer\")\n      .attr(\"transform\", `translate(${state.w + margin.right + margin.left}, ${margin.top + 35})`)\n      .on(\"click\", handleClick)\n    \n    resetButton.append(\"rect\")\n      .attr(\"x\", 0)\n      .attr(\"y\", 0)\n      .attr(\"width\", 60)\n      .attr(\"height\", 25)\n      .attr(\"rx\", 5)\n      .attr(\"ry\", 5)\n      .style(\"fill\", \"#ECECEC\")\n      .style(\"stroke\", \"black\")\n      .style(\"stroke-width\", 2);\n      \n    resetButton.on(\"mouseover\", function() {\n    d3.select(this).select(\"rect\")\n      .style(\"fill\", \"darkgray\");\n  })\n  .on(\"mouseout\", function() {\n    d3.select(this).select(\"rect\")\n      .style(\"fill\", \"#ECECEC\");\n  });\n    \n    resetButton.append(\"text\")\n      .attr(\"x\", 30)\n      .attr(\"y\", 15)\n      .attr(\"text-anchor\", \"middle\")\n      .attr(\"alignment-baseline\", \"middle\")\n      .attr(\"fill\", \"black\")\n      .attr(\"font-size\", 14)\n      .text(\"Reset\")\n    \n    // Click event handler\n    function handleClick() {\n      // Remove all new lines\n      paths.forEach(function(path) {\n        path.remove();\n      });\n    \n      // Reset paths and lineGens arrays\n      paths = [];\n      lineGens = [];\n      if (isDrawing) {\n        newLine();\n      }\n      start_drawer(state, reset = true)\n    }\n  }\n  \n  setup_draw_watcher(state.svg, scales, on_drag, on_end);\n  \n  // Do we have a title?\n    if(state.title){\n      if (state.subtitle) {\n        state.svg.append('text')\n        .at({\n          y: -margin.top/2 - 10,\n          dominantBaseline: 'middle',\n          fontSize: '1.3rem',\n        })\n        .style('font-family', system_font)\n        .text(state.title);\n      }\n      else {\n        state.svg.append('text')\n        .at({\n          y: -margin.top/2,\n          dominantBaseline: 'middle',\n          fontSize: '1.5rem',\n        })\n        .style('font-family', system_font)\n        .text(state.title);\n      }\n    }\n    \n    // Do we have a subtitle?\n    if (state.subtitle){\n      state.svg.append('text')\n      .at({\n        y: -margin.top/2 + 10,\n        dominantBaseline: 'middle',\n        fontSize: '0.8rem',\n      })\n      .style('font-family', system_font)\n      .text(state.subtitle);\n    }\n    \n    // Do we have an x-axis label?\n    if (state.x_lab) {\n      if (state.subtitle) {\n        state.svg.append('text')\n        .at({\n          x: state.w / 2,\n          y: state.h + margin.bottom,\n          fontSize: '0.8rem',\n          textAnchor: 'middle',\n        })\n        .style('font-family', system_font)\n        .text(state.x_lab);\n      }\n      else {\n        state.svg.append('text')\n        .at({\n          x: state.w / 2,\n          y: state.h + margin.bottom,\n          fontSize: '1rem',\n          textAnchor: 'middle',\n        })\n        .style('font-family', system_font)\n        .text(state.x_lab);\n      }\n    }\n    \n    // Do we have a y-axis label?\n    if (state.y_lab) {\n      if (state.subtitle) {\n        state.svg.append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"x\", 0 - (state.h / 2))\n        .attr(\"y\",  -margin.right - 22)\n        .attr(\"font-size\", \"0.8rem\")\n        .attr(\"text-anchor\", \"middle\")\n        .style(\"font-family\", system_font)\n        .text(state.y_lab);\n    }\n      else {\n      state.svg.append(\"text\")\n        .attr(\"transform\", \"rotate(-90)\")\n        .attr(\"x\", 0 - (state.h / 2))\n        .attr(\"y\",  -margin.right - 22)\n        .attr(\"font-size\", \"1rem\")\n        .attr(\"text-anchor\", \"middle\")\n        .style(\"font-family\", system_font)\n        .text(state.y_lab);\n      }\n    }\n}\n\n  function simplify_data({line_data, x_range, threshold_percentage}) {\n    // simplify the drawable_points by binning the points based on a certain threshold_percentage\n    // only allow 3 points per bin (when too many points in a cluster drawing line takes a while and \n    // if a large cluster can sometime be impossible to draw)\n    const bin_size = x_range * threshold_percentage;\n    const simplified_points = [];\n    let current_bin = [];\n  \n    for (let i = 0; i < line_data.length; i++) {\n      current_bin.push(line_data[i]);\n      \n      // if at last point or all points in bin x range have been added \n      if (i === line_data.length - 1 || line_data[i + 1].x - current_bin[0].x > bin_size) {\n        // if there are more than 3 points in bin add the first, middle, and last point to drawable_points\n        if (current_bin.length >= 3) {\n          simplified_points.push(current_bin[0], current_bin[Math.floor(current_bin.length / 2)], current_bin[current_bin.length - 1]);\n          // else add all points in current bin to drawable_points\n        } else {\n          simplified_points.push(...current_bin);\n        }\n        // reset current bin to empty\n        current_bin = [];\n      }\n    }\n    return simplified_points;\n  }\n  \n  function interpolate_x({x_range, threshold_size, simplified_points}) {\n    // Set threshold distance as % of the x-range\n    const threshold_distance = x_range * threshold_size;\n    \n    // interpolate x value (adds drawble_points between extreme x values so the line does not jump)\n    let drawable_points = [];\n\n    for (let i = 0; i < simplified_points.length; i++) {\n      const d = simplified_points[i];\n      drawable_points.push(d);\n\n      // If there is another point after this one and their X-distance is larger than \n      // the threshold value then we need to add interpolated points between them.\n      if (i + 1 < simplified_points.length && Math.abs(simplified_points[i+1].x - d.x) > threshold_distance) {\n\n        const interpolated_x = d3.range(d.x + threshold_distance, simplified_points[i+1].x, threshold_distance);\n\n        interpolated_x.forEach((x,i) => {\n          drawable_points.push({\n            x: x,\n            y: null\n          });\n        })\n        \n       }\n     }\n     //remove the repeated x values from drawable_points\n     return drawable_points\n}\n\n  function setup_drawable_points({line_data, free_draw, draw_start}){\n    if (free_draw) {\n      if (state.x_range && (state.x_range[0] < line_data[0].x)) {\n        line_data.unshift({ x: state.x_range[0], y: null });\n      }\n      if (state.x_range && state.x_range[1] > line_data[line_data.length - 1].x) {\n       line_data.push({ x: state.x_range[1], y: null });\n      }\n      \n      // Get range of x values from first and last point\n      const x_range = line_data[line_data.length - 1].x - line_data[0].x\n      \n      let simplified_points = simplify_data({line_data, x_range, threshold_percentage: 0.05})\n      \n      let drawable_points = interpolate_x({x_range, threshold_size: 0.10, simplified_points})\n      \n      //remove the repeated x values from drawable_points\n      return drawable_points\n                .filter((d, i, arr) => i === 0 || d.x !== arr[i - 1].x)\n                .map((d) => ({ x: d.x, y: null }));;\n    } else {\n      return line_data\n      .filter(d => d.x >= draw_start)    \n      .map((d,i) => ({\n        x: d.x,\n        y: i === 0 ? d.y: null\n      }));\n    }\n  }\n\nfunction get_user_line_status({drawable_points, free_draw}){\n  const num_points = drawable_points.length;\n  const num_filled = d3.sum(drawable_points.map(d => d.y === null ? 0: 1));\n  const num_starting_filled = free_draw ? 0: 1;\n  \n  if(num_filled === num_starting_filled){\n    return 'unstarted';\n  } else if(num_points === num_filled){\n    return 'done';\n  } else {\n    return 'in_progress';\n  }\n}\n\n// Draw visable portion of line\nfunction draw_true_line({svg, line_data, draw_start}, scales){\n  var df = line_data.filter(function(d){ return d.x<=draw_start})\n  state.svg.selectAppend(\"path.shown_line\")\n  .datum(df)\n  .at(default_line_attrs)\n  .attr(\"d\", scales.line_drawer);\n}\n\nfunction draw_points({svg, point_data, points_end, points}, scales){\n  \n    if(points == \"partial\"){\n      var df = point_data.filter(function(d){return (d.x<=points_end)});\n    } else {\n      var df = point_data;\n    }\n    \n  const dots = state.svg.selectAll(\"circle\").data(df)\n  \n  dots\n    .enter().append(\"circle\")\n    .merge(dots)\n    .attr(\"cx\", d => scales.x(d.x))\n    .attr(\"cy\", d => scales.y(d.y))\n    .attr(\"r\", 2)\n    .style(\"fill\", \"black\")\n    .style(\"opacity\", 0.8)\n    .style(\"stroke\", \"black\")\n    \n}\n\nif ((state.show_tooltip) || (typeof Shiny !== 'undefined')) {\n  var tooltip = d3.select(\"body\").append(\"div\")\n  .attr(\"class\", \"tooltip\")\n  .style(\"position\", \"absolute\")\n  .style(\"opacity\", 0)\n  .style(\"padding\", \"6px\")\n  .style(\"background-color\", \"#fff\")\n  .style(\"color\", \"#333\")\n  .style(\"border\", \"1px solid #ccc\")\n  .style(\"border-radius\", \"4px\")\n  .style(\"font-size\", \"14px\")\n  .style(\"pointer-events\", \"none\");\n}\n\nif(typeof Shiny !== 'undefined') {\n  // Recieve message from shiny to show or hide tooltip\n  Shiny.addCustomMessageHandler(\"tooltipState\", function(newState) {\n    if (newState) {\n      tooltip = d3.select(\"body\").append(\"div\")\n        .attr(\"class\", \"tooltip\")\n        .style(\"position\", \"absolute\")\n        .style(\"opacity\", 0)\n        .style(\"padding\", \"6px\")\n        .style(\"background-color\", \"#fff\")\n        .style(\"color\", \"#333\")\n        .style(\"border\", \"1px solid #ccc\")\n        .style(\"border-radius\", \"4px\")\n        .style(\"font-size\", \"14px\")\n        .style(\"pointer-events\", \"none\");\n    }\n    else {\n      d3.select(\".tooltip\").remove();\n    }\n  });\n}\n\nfunction draw_rectangle({svg, drawable_points, line_data, draw_start, width, height, free_draw, x_by}, scales){\n    if(get_user_line_status(state) === 'unstarted'){\n      if(free_draw){\n         var xmin = line_data[0].x\n         var len  = line_data.length - 1\n         var xmax = line_data[len].x\n         var drawSpace_start = scales.x(xmin)\n         var drawSpace_end   = scales.x(xmax)\n       } else {\n         var drawSpace_start = scales.x(draw_start)\n         var drawSpace_end   = state.w\n       }\n    } else {\n      if(get_user_line_status(state) === 'done'){\n        var drawSpace_start = scales.x(1000000)\n      } else {\n        var df = drawable_points.filter(function(d){return (d.y === null)});\n        var xmin = df[0].x - x_by\n        var len  = line_data.length - 1\n        var xmax = line_data[len].x\n        var drawSpace_start = scales.x(xmin)\n        var drawSpace_end   = scales.x(xmax)\n      }\n    }\n\n    const draw_region = state.svg.selectAppend(\"rect\");\n\n    draw_region\n      .attr(\"x\", drawSpace_start)\n      .attr(\"width\",drawSpace_end - drawSpace_start)\n      .attr(\"y\", 0)\n      .attr(\"height\", state.h)\n      //.style(\"fill\", \"#e0f3f3\")\n      .style(\"fill-opacity\", 0.4)\n      .style(\"fill\", \"rgba(255,255,0,.8)\")\n\n    if (typeof tooltip !== 'undefined') {\n      svg.on(\"mousemove\", function(d) {\n      // Get the mouse coordinates relative to the SVG container\n      var [mouseX, mouseY] = d3.mouse(this);\n  \n      // Check if the mouse is within the rectangle's bounds\n      var isMouseOverDrawRegion =\n        mouseX >= drawSpace_start &&\n        mouseX <= drawSpace_end &&\n        mouseY >= 0 &&\n        mouseY <= state.h;\n  \n      if (isMouseOverDrawRegion) {\n        // Calculate the progress based on the width of draw_region relative to the total width\n        var progress = (1 - (drawSpace_end - drawSpace_start) / (drawSpace_end));\n        \n        // Set the progress to a minimum of 0 if it is negative\n        progress = Math.max(progress, 0);\n        \n        // Show tooltip\n        tooltip.transition()\n          .duration(200)\n          .style(\"opacity\", 1);\n        tooltip.html(\"Progress: \" + (progress * 100).toFixed(2) + \"%\")\n          .style(\"left\", (d3.event.pageX + 10) + \"px\")\n          .style(\"top\", (d3.event.pageY - 28) + \"px\");\n      } else {\n        // Hide tooltip\n        tooltip.transition()\n          .duration(200)\n          .style(\"opacity\", 0);\n      }\n    });\n    \n    // Hide tooltip when mouse leaves the SVG container\n    svg.on(\"mouseleave\", function() {\n      tooltip.transition()\n        .duration(200)\n        .style(\"opacity\", 0);\n    });\n    }\n}\n\nfunction draw_user_line(state, scales){\n  const {svg, drawable_points, drawn_line_color} = state;\n  \n  const user_line = state.svg.selectAppend(\"path.user_line\");\n  \n  // Only draw line if there's something to draw.\n  if(get_user_line_status(state) === 'unstarted'){\n    user_line.remove();\n    return;\n  }\n\n  // Draws the points the user is drawing with their mouse\n  user_line\n      .datum(drawable_points)\n      .at(default_line_attrs)\n      .attr('stroke', drawn_line_color)\n      .attr(\"d\", scales.line_drawer)\n      .style(\"stroke-dasharray\", (\"1, 7\"));\n}\n\nfunction draw_finished_line({svg, line_data, draw_start, free_draw}, scales){\n  \n  \n  if(!free_draw){\n    var df = line_data.filter(function(d){ return d.x >= draw_start})\n    if (state.conf_int) {\n      var lwr = state.lower_bound.filter(function(d){ return d.x >= draw_start})\n      var upr = state.upper_bound.filter(function(d){ return d.x >= draw_start})\n    }\n  } else {\n    var df = line_data\n    if (state.conf_int) {\n      var lwr = state.lower_bound\n      var upr = state.upper_bound\n    }\n  }\n  \n  \n  const finished_line = state.svg.selectAppend(\"path.finished_line\")\n  const lower_bound = state.svg.selectAppend(\"path.lower_bound\")\n  const upper_bound = state.svg.selectAppend(\"path.upper_bound\")\n  \n    // Only draw line if there's something to draw.\n  if(get_user_line_status(state) === 'unstarted'){\n    finished_line.remove();\n    if (state.conf_int) {\n      lower_bound.remove();\n      upper_bound.remove();\n    }\n    return;\n  }\n  \n  finished_line\n  .datum(df)\n  .at(default_line_attrs)\n  .attr(\"d\", scales.line_drawer)\n  .attr(\"opacity\", 0.5)\n\n  if (state.conf_int) {\n    lower_bound\n    .datum(lwr)\n    .at(conf_int_line_attrs)\n    .attr(\"d\", scales.line_drawer)\n    .attr(\"opacity\", 0.5)\n    \n    upper_bound\n    .datum(upr)\n    .at(conf_int_line_attrs)\n    .attr(\"d\", scales.line_drawer)\n    .attr(\"opacity\", 0.5)\n  }\n  \n}\n\n// from state we need drawable_points - from setup_drawable_points() function that modifies state (get all x points bigger than or equal to draw_start and set up with a null), pin_start, and free_draw parameters\n// drag_x, drag_y come from on_drag() function\nfunction fill_in_closest_point({drawable_points, pin_start, free_draw}, drag_x, drag_y){\n  // find closest point on data to draw\n  let last_dist = Infinity;\n  let current_dist;\n  // If nothing triggers break statement than closest point is last point\n  let closest_index = drawable_points.length - 1;\n  const starting_index = free_draw ? 0 : (pin_start ? 1: 0);\n  // for loop to check where closest point to where I am\n  for(i = starting_index; i < drawable_points.length; i++){\n    current_dist = Math.abs(drawable_points[i].x - drag_x);\n    // If distances start going up we've passed the closest point\n    if(last_dist - current_dist < 0) {\n      closest_index = i - 1;\n      break;\n    }\n    last_dist = current_dist;\n  }\n  \n  drawable_points[closest_index].y = drag_y;\n}\n\n\nfunction setup_draw_watcher(svg, scales, on_drag, on_end){\n  \n  // could have called drag_watcher whatever we wanted\n  // .at is space it begins watching\n  // .call is \"do something\" d3.drag() is the mouse action puts listeners to react to user input.\n  svg.selectAppend('rect.drag_watcher')\n  .at({\n    height: scales.y.range()[0],\n    width: scales.x.range()[1],\n    fill: 'grey',\n    fillOpacity: 0,\n  })\n  .call(\n    d3.drag()\n    .on(\"drag\", on_drag)\n    .on(\"end\", on_end)\n  );\n}\n\n// Setup scales for visualization\nfunction setup_scales(state){\n  // multi-assign: x_range, etc. coming from options\n  const {w, h, line_data, x_range, y_range, x_name, y_name, linear} = state;\n  \n  // convert x from data scale to pixle scale\n  const x = d3.scaleLinear()\n  .domain(x_range || d3.extent(line_data, d => d.x))\n  .range([0, w]);\n  \n  //console.log(linear);\n  if (linear == 'true') {\n    //console.log('in linear block');\n    // converts from data linear scale to pixle scale\n    var y = d3.scaleLinear()\n    .domain(y_range || d3.extent(line_data, d => d.y))\n    .range([h, 0]);\n  } else {\n    //console.log('in log block');\n    // converts from data log scale to pixle scale\n    if (state.log_base == null) {\n      var y = d3.scaleLog()\n      .domain(y_range || d3.extent(line_data, d => d.y))\n      .range([h, 0]).base(Math.E);\n    }\n    else {\n      var y = d3.scaleLog()\n      .domain(y_range || d3.extent(line_data, d => d.y))\n      .range([h, 0]).base(state.log_base);\n    }\n  }\n  \n  const xAxis = d3.axisBottom().scale(x).tickSizeOuter(0);\n  const yAxis = d3.axisLeft().scale(y).tickFormat(d3.format(\".4\")).tickSizeOuter(0);\n  const xAxisGrid = d3.axisBottom().scale(x).tickSize(-h).tickFormat('');\n  const yAxisGrid = d3.axisLeft().scale(y).tickSize(-w).tickFormat('');\n  \n  // Remove all grid related things first\n  // remove everything when you convert from linear and log and vise versa.\n  // want html element <g> that has class axis-grid\n  state.svg.selectAll(\"g.x_grid\").remove()\n  state.svg.selectAll(\"g.y_grid\").remove()\n  // could call axis-grid \"fred\"\n  state.svg.selectAll(\"g.axis-grid\").remove()\n  \n  state.svg.selectAll(\"path.shown_line\").remove()\n  state.svg.selectAll(\"circle\").remove()\n  \n  state.svg.selectAppend(\"g.x_grid\")\n  .attr('class', 'x axis-grid')\n  .translate([0,h])\n  .call(xAxisGrid);\n  \n  state.svg.selectAppend(\"g.y_grid\")\n  .attr('class', 'y axis-grid')\n  .call(yAxisGrid);\n  \n  state.svg.selectAll(\".axis-grid .tick\")\n  .style(\"stroke\", \"light-grey\")\n  .style(\"opacity\", \".3\");\n  \n  state.svg.selectAppend(\"g.x_axis\")\n  .translate([0,h])\n  .call(xAxis);\n  \n  state.svg.selectAppend(\"g.y_axis\")\n  .call(yAxis);\n  \n  const line_drawer = d3.line()\n  .defined(d => d.y !== null)\n  .x(d => x(d.x))\n  .y(d => y(d.y));\n  \n  return {\n    x,\n    y,\n    line_drawer,\n  };\n}\n};","style":[],"version":5,"theme":{"default":{"background":"#FFFFFF","foreground":"#000000"},"runtime":null},"useShadow":true},"evals":[],"jsHooks":[]}</script>
</div>
<div class="section level2">
<h2 id="shiny-app">Shiny App<a class="anchor" aria-label="anchor" href="#shiny-app"></a>
</h2>
<iframe src="https://dillonmurphy.shinyapps.io/youdrawit/" style="width:100%; height:500px;" class="shiny-app">
</iframe>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Emily A. Robinson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
